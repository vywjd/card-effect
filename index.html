<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
        }
        .wrapper {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100vw;
            height: 100vh;
            background-color: #eee;
            user-select: none;
        }
        .grid-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(5, 1fr);
            aspect-ratio: 1 / 1;
            /* 임시 코드 */
            /* width: 600px; */
            width: min(80vw, 80vh);
            background-color: white;
            gap: 10px;
            padding: 10px;
        }
        .card {
            background-color: skyblue;
            border-radius: 10%;
            border: 2px solid gray;
            color: gray;
            transition: transform 0.5s ease-out;
        }
    </style>
</head>
<body>
    <div class="wrapper">
        <div class="grid-container">
            <div class="card">1</div>
            <div class="card">2</div>
            <div class="card">3</div>
            <div class="card">4</div>
            <div class="card">5</div>
            <div class="card">6</div>
            <div class="card">7</div>
            <div class="card">8</div>
            <div class="card">9</div>
            <div class="card">10</div>
            <div class="card">11</div>
            <div class="card">12</div>
            <div class="card">13</div>
            <div class="card">14</div>
            <div class="card">15</div>
            <div class="card">16</div>
            <div class="card">17</div>
            <div class="card">18</div>
            <div class="card">19</div>
            <div class="card">20</div>
            <div class="card">21</div>
            <div class="card">22</div>
            <div class="card">23</div>
            <div class="card">24</div>
            <div class="card">25</div>

        </div>
    </div>
<script>
let isInteracting = false;
const cards = document.querySelectorAll('.card');

cards.forEach((card, index) => {
    const hue = (index / cards.length) * 90 + 90;
    card.style.backgroundColor = `hsl(${hue}, 70%, 80%)`;
});

const updateRotation = (pos) => {
  cards.forEach(card => {
    const rect = card.getBoundingClientRect();
    const centerX = rect.left + rect.width / 2;
    const centerY = rect.top + rect.height / 2;

    const x = pos.clientX - centerX;
    const y = pos.clientY - centerY;

    const win_min = Math.min(window.innerWidth, window.innerHeight);
    const max_rotate = 40;

    let rotateX = (-max_rotate / win_min) * y * 2;
    let rotateY = (max_rotate / win_min) * x * 2;

    const length = Math.hypot(rotateX, rotateY);

    card.style.transform = `
      perspective(1000px)
      rotate3d(${rotateX / length}, ${rotateY / length}, 0, ${length}deg)
    `;
  });
};

// PC 마우스 이벤트
document.addEventListener('mousedown', (e) => {
  isInteracting = true;
  updateRotation(e);
});
document.addEventListener('mousemove', (e) => {
  if (isInteracting) updateRotation(e);
});
document.addEventListener('mouseup', () => {
  isInteracting = false;
  cards.forEach(card => card.style.transform = 'none');
});

// 모바일 터치 이벤트
document.addEventListener('touchstart', (e) => {
  isInteracting = true;
  updateRotation(e.touches[0]);
}, { passive: true });

document.addEventListener('touchmove', (e) => {
  if (isInteracting) updateRotation(e.touches[0]);
}, { passive: true });

document.addEventListener('touchend', () => {
  isInteracting = false;
  cards.forEach(card => card.style.transform = 'none');
});
</script>

</body>
</html>